---
ID: "cc47af16-1c8c-4b66-bbc2-dc749454d046"
Parent: "4ff2646c-2b0f-428f-b9a0-d6ea531de713"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: "/sitecore/system/Modules/PowerShell/Script Library/Click Click Launch/Functions/Update-LinkField"
SharedFields:
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    function Update-LinkField {
        param(
            [Parameter(Mandatory = $true)]
            [Sitecore.Data.Items.Item] $Item,
            [Parameter(Mandatory = $true)]
            [String]$FieldName,
            [Parameter(Mandatory = $false)]
            [Sitecore.Data.Items.Item]$TargetItem,
            [Parameter(Mandatory = $false)]
            [String]$Url
            )
        
        process {
            Write-Verbose "Editing link field [$($FieldName)]"
            $Item.Editing.BeginEdit()
            [Sitecore.Data.Fields.LinkField]$linkField = $Item.Fields[$FieldName]
            Write-Verbose "linkField [$($linkField.LinkType)]"
            if ($TargetItem -ne $null) {
                Write-Verbose "Setting internal link"
                $linkField.LinkType = "internal"
                $linkField.TargetID = $TargetItem.ID
                $linkField.Url = $null
            } 
            else {
                Write-Verbose "Setting external link"
                $linkField.LinkType = "external"
                $linkField.TargetID = $null
                $linkField.Url = $Url
            }
            $Item.Editing.EndEdit()
        }
    }
- ID: "dbbbeca1-21c7-4906-9dd2-493c1efa59a2"
  Hint: __Shared revision
  Value: "a11108cb-5e70-4e6e-8abe-cdc666d24e35"
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20250707T200641Z
    - ID: "52807595-0f8f-4b20-8d2a-cb71d28c6103"
      Hint: __Owner
      Value: |
        sitecore\richard.seal@sitecore.com
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\richard.seal@sitecore.com
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "4be558bf-297d-4fb6-b944-38d5f17c6774"
    - ID: "badd9cf9-53e0-4d0c-bcc0-2d784c282f6a"
      Hint: __Updated by
      Value: |
        sitecore\richard.seal@sitecore.com
    - ID: "d9cf14b1-fa16-4ba6-9288-e8a174d4d522"
      Hint: __Updated
      Value: 20250707T220649Z
